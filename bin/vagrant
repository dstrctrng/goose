#!/usr/bin/env bash

shome="$(unset CDPATH; cd -P -- "$(dirname -- "$BASH_SOURCE")/.." && pwd -P)"
export PATH="$shome/bin:$PATH"

export VBOX_USER_HOME="$shome/.vagrant.d"
export VAGRANT_HOME="$shome/.vagrant.d"

pth_vagrant="$(bundle exec which vagrant 2>&- || true)"
if [[ "$pth_vagrant" = "$shome/bin/vagrant" ]]; then
  printf 'ERROR: vagrant not found, run make' 1>&2
  exit 1
fi

exec bundle exec vagrant "$@"
